<script>
  // Extract QR Code URL passed from index.html
  const urlParams = new URLSearchParams(window.location.search);
  const qrImageURL = urlParams.get('qr'); // QR code URL passed as a query parameter

  if (qrImageURL) {
    // Show the QR code from the URL
    const qrcodeContainer = document.getElementById('qrcode');
    new QRCode(qrcodeContainer, {
      text: qrImageURL, // Set the URL to the QR code text
      width: 150,
      height: 150,
      colorDark: "#000000", // Default dot color
      colorLight: "#ffffff", // Background color
    });
  } else {
    // If no QR code URL is passed, show an error message
    alert("QR code URL not found.");
  }

  // Function to change the QR code color
  function changeQRCodeColor() {
    const colorInput = document.getElementById('colorInput').value;
    const qrcodeContainer = document.getElementById('qrcode');
    qrcodeContainer.innerHTML = ''; // Clear the existing QR code

    if (qrImageURL) {
      new QRCode(qrcodeContainer, {
        text: qrImageURL,
        width: 150,
        height: 150,
        colorDark: colorInput, // Apply selected color
        colorLight: "#ffffff",
      });
    }
  }

  // Function to download the QR code as an image
  function downloadQRCode() {
    const qrcodeCanvas = document.querySelector("#qrcode canvas");
    if (qrcodeCanvas) {
      const downloadLink = document.createElement('a');
      downloadLink.href = qrcodeCanvas.toDataURL("image/png");
      downloadLink.download = 'qrcode.png';
      downloadLink.click();
    } else {
      alert("QR code not available for download.");
    }
  }
</script>
